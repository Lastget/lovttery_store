{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link,useSearchParams,useNavigate,useLocation}from'react-router-dom';import{Form,Button,Row,Col,Image,ListGroup,ListGroupItem,Card}from'react-bootstrap';import Loader from'../components/Loader';import Message from'../components/Message';import FormContainer from'../components/FormContainer';import CheckoutStep from'../components/CheckoutStep';import{useDispatch,useSelector}from'react-redux';import{createOrder}from'../actions/orderAction';import*as cons from'../constants/orderContants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function PlaceOrderScreen(){var cart=useSelector(function(state){return state.cart;});var dispatch=useDispatch();var navigate=useNavigate();var orderCreate=useSelector(function(state){return state.orderCreate;});var order=orderCreate.order,error=orderCreate.error,success=orderCreate.success;cart.itemsPrice=cart.cartItems.reduce(function(acc,item){return acc+item.price*item.qty;},0).toFixed(2);cart.shippingPrice=(cart.itemsPrice>100?0:10).toFixed(2);cart.taxPrice=Number(cart.itemsPrice*0.082).toFixed(2);cart.totalPrice=(Number(cart.itemsPrice)+Number(cart.shippingPrice)+Number(cart.taxPrice)).toFixed(2);useEffect(function(){if(success){navigate(\"/order/\".concat(order._id));dispatch({type:cons.ORDER_CREATE_RESET});}if(!cart.paymentMethod){navigate(\"/payment\");}},[success,navigate,cart]);var placeOrder=function placeOrder(){dispatch(createOrder({orderItems:cart.cartItems,shippingAddress:cart.shippingAddress,paymentMethod:cart.paymentMethod,itemsPrice:cart.itemsPrice,shippingPrice:cart.shippingPrice,taxPrice:cart.taxPrice,totalPrice:cart.totalPrice}));};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CheckoutStep,{step1:true,step2:true,step3:true,step4:true}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:8,children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\" Shipping \"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\" Shipping: \"}),cart.shippingAddress.address,\", \",cart.shippingAddress.city,' ',\", \",cart.shippingAddress.postalCode,' ',\",\",cart.shippingAddress.country]})]}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\" Payment Method \"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\" Method: \"}),cart.paymentMethod]})]}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\" Order Items  \"}),cart.cartItems.length===0?/*#__PURE__*/_jsx(Message,{variant:\"info\",children:\"Your cart is empty.\"}):/*#__PURE__*/_jsx(ListGroup,{variant:\"flush\",children:cart.cartItems.map(function(item,index){return/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:1,children:/*#__PURE__*/_jsx(Image,{src:item.image,alt:item.name,fluid:true,rounded:true})}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(Link,{to:\"/product/\".concat(item.product),children:[\" \",item.name,\" \"]})}),/*#__PURE__*/_jsxs(Col,{md:4,children:[item.qty,\" X $\",item.price,\" = $\",(item.qty*item.price).toFixed(2)]})]})},index);})})]})]})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(ListGroup,{children:[/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(\"h2\",{children:\" Order Summary \"})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\" Item: \"}),/*#__PURE__*/_jsxs(Col,{children:[\" $\",cart.itemsPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\" Shipping: \"}),/*#__PURE__*/_jsxs(Col,{children:[\" $\",cart.shippingPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\" Tax: \"}),/*#__PURE__*/_jsxs(Col,{children:[\" $\",cart.taxPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\" Total: \"}),/*#__PURE__*/_jsxs(Col,{children:[\" $\",cart.totalPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:error&&/*#__PURE__*/_jsxs(Message,{variant:\"danger\",children:[\" \",error,\" \"]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(Button,{type:\"button\",className:\"btn-block\",disabled:cart.cartItems===0,onClick:placeOrder,children:\"Place Order\"})})]})})})]})]});}","map":{"version":3,"names":["React","useState","useEffect","Link","useSearchParams","useNavigate","useLocation","Form","Button","Row","Col","Image","ListGroup","ListGroupItem","Card","Loader","Message","FormContainer","CheckoutStep","useDispatch","useSelector","createOrder","cons","PlaceOrderScreen","cart","state","dispatch","navigate","orderCreate","order","error","success","itemsPrice","cartItems","reduce","acc","item","price","qty","toFixed","shippingPrice","taxPrice","Number","totalPrice","_id","type","ORDER_CREATE_RESET","paymentMethod","placeOrder","orderItems","shippingAddress","address","city","postalCode","country","length","map","index","image","name","product"],"sources":["/Users/richy_air/Documents/project/ecommerece/backend/frontend/src/screens/PlaceOrderScreen.js"],"sourcesContent":["import React, {useState, useEffect} from 'react'\nimport {Link, useSearchParams, useNavigate, useLocation } from 'react-router-dom'\nimport {Form, Button, Row, Col, Image, ListGroup, ListGroupItem, Card} from 'react-bootstrap'\nimport Loader from '../components/Loader'\nimport Message from '../components/Message'\nimport FormContainer from '../components/FormContainer'\nimport CheckoutStep from '../components/CheckoutStep'\nimport {useDispatch, useSelector } from 'react-redux'\nimport {createOrder} from '../actions/orderAction'\nimport * as cons from '../constants/orderContants'\n\n\nexport default function PlaceOrderScreen() {\n    const cart = useSelector(state => state.cart) \n    const dispatch = useDispatch()\n    const navigate = useNavigate()\n\n    const orderCreate = useSelector(state => state.orderCreate)\n    const {order, error, success} = orderCreate\n\n    cart.itemsPrice = cart.cartItems.reduce((acc,item) => acc + item.price * item.qty, 0).toFixed(2)\n    cart.shippingPrice = (cart.itemsPrice > 100 ? 0 : 10).toFixed(2)\n    cart.taxPrice = Number(cart.itemsPrice * (0.082)).toFixed(2)\n    cart.totalPrice = ( Number(cart.itemsPrice) + Number(cart.shippingPrice) +  Number(cart.taxPrice)).toFixed(2)\n\n\n\n    useEffect(() => {\n        if(success){\n            navigate(`/order/${order._id}`)\n            dispatch({type: cons.ORDER_CREATE_RESET})\n        }\n        if(!cart.paymentMethod){\n            navigate(`/payment`)\n        }\n    },[success, navigate, cart])\n\n    const placeOrder = () => {\n        dispatch(createOrder({\n            orderItems: cart.cartItems,\n            shippingAddress: cart.shippingAddress,\n            paymentMethod: cart.paymentMethod,\n            itemsPrice: cart.itemsPrice,\n            shippingPrice : cart.shippingPrice,\n            taxPrice: cart.taxPrice,\n            totalPrice: cart.totalPrice\n        }))\n    }\n\n\n\n\n  return (\n    <div>\n        <CheckoutStep step1 step2 step3 step4 /> \n        <Row>\n            <Col md ={8}>\n                <ListGroup variant='flush'> \n                    <ListGroup.Item> \n                        <h2> Shipping </h2>\n                        <p> \n                            <strong> Shipping: </strong>\n                            {cart.shippingAddress.address}, {cart.shippingAddress.city}\n                            {' '}, {cart.shippingAddress.postalCode}\n                            {' '},\n                            {cart.shippingAddress.country}\n                        </p>  \n                    </ListGroup.Item>\n\n                    <ListGroup.Item> \n                        <h2> Payment Method </h2>\n                        <p> \n                            <strong> Method: </strong>\n                            {cart.paymentMethod}\n                        </p>  \n                    </ListGroup.Item>\n\n                    <ListGroup.Item> \n                        <h2> Order Items  </h2>\n                        {cart.cartItems.length === 0 ? <Message variant='info'> \n                            Your cart is empty. \n                            </Message>: (\n                                <ListGroup variant='flush'> \n                                    {cart.cartItems.map((item, index) => (\n                                        <ListGroup.Item key={index}> \n                                            <Row> \n                                                <Col md={1}> \n                                                <Image src={item.image} alt={item.name} fluid rounded/>\n                                                </Col>\n\n                                                <Col>\n                                                    <Link to = {`/product/${item.product}`}> {item.name} </Link> \n                                                </Col>\n\n                                                <Col md={4}> \n                                                    {item.qty} X ${item.price} = ${(item.qty * item.price).toFixed(2)}\n                                                </Col>\n                                            </Row>\n                                        </ListGroup.Item>\n                                    ))}\n                                </ListGroup>\n\n                            )}\n                    </ListGroup.Item>\n\n                </ListGroup>\n            </Col>\n\n            <Col md={4}>\n                <Card> \n                    <ListGroup>\n                        <ListGroup.Item> \n                            <h2> Order Summary </h2>\n                        </ListGroup.Item>\n\n                        <ListGroup.Item> \n                            <Row> \n                                <Col> Item: </Col>\n                                <Col> ${cart.itemsPrice}</Col>\n                            </Row>\n                        </ListGroup.Item>\n\n                        <ListGroup.Item> \n                            <Row> \n                                <Col> Shipping: </Col>\n                                <Col> ${cart.shippingPrice}</Col>\n                            </Row>\n                        </ListGroup.Item>\n\n                        <ListGroup.Item> \n                            <Row> \n                                <Col> Tax: </Col>\n                                <Col> ${cart.taxPrice}</Col>\n                            </Row>\n                        </ListGroup.Item>\n\n                        <ListGroup.Item> \n                            <Row> \n                                <Col> Total: </Col>\n                                <Col> ${cart.totalPrice}</Col>\n                            </Row>\n                        </ListGroup.Item>\n\n                        <ListGroup.Item> \n                           {error && <Message variant='danger'> {error} </Message>}\n                        </ListGroup.Item>\n                    \n\n                        <ListGroup.Item> \n                            <Button\n                                type='button'\n                                className ='btn-block'\n                                disabled= {cart.cartItems === 0}\n                                onClick = {placeOrder}\n                            > \n                                Place Order\n                            </Button>\n                        </ListGroup.Item>\n                    </ListGroup>  \n\n                </Card>\n            </Col>\n        </Row>\n\n    </div>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}